# 图片转PDF综合工具 4.0

这是一个功能全面的Python工具，支持从多种图片源（zip压缩包、文件夹）提取图片并合并成PDF文件。

## 🎯 功能特点

- 🗜️ **支持zip压缩包**: 直接从zip文件中提取图片，无需手动解压
- 📁 **支持文件夹处理**: 处理文件夹中的图片文件
- 📄 **智能PDF合并**: 将图片按自然顺序排列并合并成单个PDF文件
- 🖼️ **多格式支持**: 支持 JPG、PNG、BMP、GIF、TIFF、WebP 等常见图片格式
- 🔄 **自动格式转换**: 自动将CMYK、RGBA、调色板等模式转换为RGB
- 📊 **进度显示**: 使用进度条显示处理进度
- 🚀 **多进程支持**: 支持多进程并行处理，提高处理速度
- 🎯 **多种处理模式**: 批量处理、单文件处理、顺序处理、并行处理
- ⚡ **智能跳过**: 自动跳过已存在的PDF文件，避免重复处理

## 📋 安装依赖

在运行程序前，请确保安装了以下Python库：

```bash
pip install Pillow tqdm
```

## 🚀 使用方法

运行程序：
```bash
python zip_to_pdf4.0.py
```

程序会显示以下处理模式供选择：

### 模式1: 批量处理zip文件
- 自动处理当前目录下所有zip文件
- 为每个zip文件生成对应的PDF文件
- 自动跳过已存在的PDF文件

### 模式2: 单个zip文件处理
- 手动指定单个zip文件进行处理
- 支持任意路径的zip文件
- 可选择是否覆盖已存在的PDF文件

### 模式3: 批量处理文件夹（顺序）
- 顺序处理当前目录下的所有子文件夹
- 为每个文件夹生成对应的PDF文件
- 适合内存较小的系统

### 模式4: 批量处理文件夹（多进程）
- 使用多进程并行处理文件夹
- 显著提高处理速度
- 自动根据CPU核心数调整进程数量

### 模式5: 单个文件夹处理
- 手动指定单个文件夹进行处理
- 支持任意路径的文件夹
- 可选择是否覆盖已存在的PDF文件

## 📤 输出说明

- **zip文件**: 生成的PDF文件名与zip文件名相同（扩展名改为.pdf）
- **文件夹**: 生成的PDF文件名与文件夹名相同（扩展名改为.pdf）
- 图片会按文件名的自然顺序排列（例如：1.jpg, 2.jpg, 10.jpg）
- PDF文件生成在源文件/文件夹所在目录

## 🖼️ 支持的图片格式

- JPEG (.jpg, .jpeg)
- PNG (.png)
- BMP (.bmp)
- GIF (.gif)
- TIFF (.tiff, .tif)
- WebP (.webp)

## ⚙️ 性能优化

### 多进程处理
- 自动检测CPU核心数
- 默认使用 CPU核心数/2 个进程
- 适合处理大量文件夹

### 内存管理
- 自动关闭图片对象，防止内存泄漏
- 处理完成后及时释放资源
- 支持处理大量图片文件

## ⚠️ 注意事项

1. **文件格式**: 确保zip文件或文件夹中包含有效的图片文件
2. **文件权限**: 确保程序有读取源文件和写入目标目录的权限
3. **磁盘空间**: 确保有足够的磁盘空间存储生成的PDF文件
4. **处理时间**: 处理大量图片时可能需要较长时间，请耐心等待
5. **特殊文件夹**: 程序会自动跳过系统文件夹（如 .git, __pycache__ 等）

## 🔧 错误处理

- **文件损坏**: 如果zip文件或图片文件损坏，程序会显示错误信息并跳过
- **格式转换**: 如果图片格式不兼容PDF，程序会尝试自动转换
- **资源清理**: 程序会自动清理临时资源，避免内存泄漏
- **异常恢复**: 单个文件处理失败不会影响其他文件的处理

## 📈 版本历史

- **4.0**: 
  - ✨ 新增zip压缩包支持
  - ✨ 集成文件夹处理功能
  - ✨ 多进程并行处理
  - ✨ 五种处理模式
  - 🔧 改进错误处理和用户界面
- **3.0**: 支持文件夹批量处理，自然排序，进度显示
- **2.0**: 多进程并行处理支持
- **1.0**: 基础图片合并PDF功能

## 📁 推荐目录结构

### 使用该程序时的理想目录结构：

```
工作目录/
├── 图片转PDF工具_完整版.exe    # 主程序文件
├── 漫画1/                      # 图片文件夹1
│   ├── 001.jpg
│   ├── 002.jpg
│   ├── 003.png
│   └── ...
├── 漫画2/                      # 图片文件夹2
│   ├── page01.jpg
│   ├── page02.jpg
│   └── ...
├── 小说插图/                   # 图片文件夹3
│   ├── 插图1.png
│   ├── 插图2.jpg
│   └── ...
├── 压缩包1.zip                 # zip压缩包（可选）
├── 压缩包2.zip                 # zip压缩包（可选）
└── 输出PDF/                    # 生成的PDF文件（自动创建）
    ├── 漫画1.pdf
    ├── 漫画2.pdf
    ├── 小说插图.pdf
    ├── 压缩包1.pdf
    └── 压缩包2.pdf
```

## 🤝 使用建议

1. **首次使用**: 建议先用单文件模式测试功能
2. **批量处理**: 对于大量文件，推荐使用多进程模式
3. **内存不足**: 如果系统内存较小，使用顺序处理模式
4. **备份重要文件**: 处理重要文件前建议先备份

pyinstaller --onefile --name="图片转PDF工具_优化" --icon="漫画.ico" --exclude-module=tkinter --exclude-module=matplotlib --exclude-module=numpy --exclude-module=pandas --exclude-module=scipy --exclude-module=IPython --exclude-module=jupyter --strip --clean --noconfirm zip_to_pdf4.0.py 
